conf_mat = [ 0.9976,  0.0012,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.0024,  0.9976,  0.0012,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.0012,  0.9976,  0.0012,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.0012,  0.9976,  0.0012,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.0012,  0.9976,  0.0012,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.0012,  0.9976,  0.0012,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0012,  0.9976,  0.0012,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0012,  0.9976,  0.0012,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0012,  0.9976,  0.0012,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0012,  0.9976,  0.0012,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0012,  0.9976,  0.0012,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0012,  0.9976,  0.0012,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0012,  0.9976,  0.0012,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0012,  0.9976,  0.0012,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0012,  0.9976,  0.0012;
        0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    ,  0.    ,  0.    ,  0.    ,  0.    , -0.    , -0.    , -0.    ,  0.0012,  0.9988];

conf_mat_16_014 = [ 0.9737,  0.0131,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.0263,  0.9737,  0.0131,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.0131,  0.9737,  0.0131,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.0131,  0.9737,  0.0131,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.0131,  0.9737,  0.0131,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.0131,  0.9737,  0.0131,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0131,  0.9737,  0.0131,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0131,  0.9737,  0.0131,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0131,  0.9737,  0.0131,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0131,  0.9737,  0.0131,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0131,  0.9737,  0.0131,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0131,  0.9737,  0.0131,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0131,  0.9737,  0.0131,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0131,  0.9737,  0.0131,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0131,  0.9737,  0.0131;
        0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    ,  0.    ,  0.0131,  0.9869];

conf_mat_16_0138 = [ 0.9843,  0.0079,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.0157,  0.9843,  0.0079,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.0079,  0.9843,  0.0079,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.0079,  0.9843,  0.0079,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.0079,  0.9843,  0.0079,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.0079,  0.9843,  0.0079,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0079,  0.9843,  0.0079,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0079,  0.9843,  0.0079,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0079,  0.9843,  0.0079,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0079,  0.9843,  0.0079,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0079,  0.9843,  0.0079,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0079,  0.9843,  0.0079,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0079,  0.9843,  0.0079,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0079,  0.9843,  0.0079,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0079,  0.9843,  0.0079;
        0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    ,  0.    ,  0.    , -0.    , -0.    , -0.    ,  0.    ,  0.0079,  0.9921];
    
conf_mat_16_0135 = [ 0.9865,  0.0068,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.0135,  0.9865,  0.0068,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.0068,  0.9865,  0.0068,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.0068,  0.9865,  0.0068,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.0068,  0.9865,  0.0068,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.0068,  0.9865,  0.0068,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0068,  0.9865,  0.0068,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0068,  0.9865,  0.0068,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0068,  0.9865,  0.0068,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0068,  0.9865,  0.0068,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0068,  0.9865,  0.0068,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0068,  0.9865,  0.0068,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0068,  0.9865,  0.0068,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0068,  0.9865,  0.0068,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0068,  0.9865,  0.0068;
        0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    ,  0.    ,  0.    , -0.    , -0.    , -0.    ,  0.    ,  0.0068,  0.9932];
    
conf_mat_16_0132 = [ 0.9884,  0.0058,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.0116,  0.9884,  0.0058,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.0058,  0.9884,  0.0058,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.0058,  0.9884,  0.0058,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.0058,  0.9884,  0.0058,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.0058,  0.9884,  0.0058,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0058,  0.9884,  0.0058,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0058,  0.9884,  0.0058,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0058,  0.9884,  0.0058,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0058,  0.9884,  0.0058,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0058,  0.9884,  0.0058,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0058,  0.9884,  0.0058,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0058,  0.9884,  0.0058,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0058,  0.9884,  0.0058,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0058,  0.9884,  0.0058;
        0.    ,  0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    ,  0.    ,  0.    , -0.    , -0.    , -0.    ,  0.    ,  0.0058,  0.9942];
    
conf_mat_16_013 = [ 0.9897,  0.0052,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.0103,  0.9897,  0.0052,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.0052,  0.9897,  0.0052,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.0052,  0.9897,  0.0052,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.0052,  0.9897,  0.0052,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.0052,  0.9897,  0.0052,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0052,  0.9897,  0.0052,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0052,  0.9897,  0.0052,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0052,  0.9897,  0.0052,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0052,  0.9897,  0.0052,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0052,  0.9897,  0.0052,  0.    ,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0052,  0.9897,  0.0052,  0.    ,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0052,  0.9897,  0.0052,  0.    ,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0052,  0.9897,  0.0052,  0.    ;
        0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.0052,  0.9897,  0.0052;
        0.    ,  0.    , -0.    , -0.    , -0.    , -0.    , -0.    , -0.    ,  0.    ,  0.    , -0.    , -0.    , -0.    ,  0.    ,  0.0052,  0.9948];
    
pp=0.001;
lp_p = pp;
mp_p = pp;
up_p = pp;
tp_p = pp;

SbS_matrices = containers.Map({1,2,3},{conf_mat_16_0135,conf_mat_16_0132,conf_mat_16_013});

% LDPC code Initialization
%[n, m, cmax, rmax, col_weight, row_weight, row_list_col, col_list_row, col_list_N, H] = InitSumProductDecoderSyndrome('peg_16000_3_0.9.txt');

num_trials = 100;
max_num_iter = 20;
num_reads = 1;      % 1 read: hard info, 3 reads: soft info
decode_mode = 0;    % 0: generated noise from SbS matrix, 1: raw read data in a file

sequential = containers.Map({1,2,3},{100,100,100});    % number of iterations in the sequential loop in the .C file
parallel = containers.Map({1,2,3},{0,0,0});          % number of iterations in the parfor loop in this script
% The previous line is for initializing the parallel container
% The for loop is to actually compute the number of parallel iterations
for i=1:length(keys(sequential))
    parallel(i) = num_trials/sequential(i);
end 
%addpath('Z:\Grid management');
sections = 2;
%curr_time   = zeros(length(keys(SbS_matrices)),sections);
%curr_workers = zeros(length(keys(SbS_matrices)),sections);
total_err_count = cell(1,length(keys(SbS_matrices)));
total_undet_err = cell(1,length(keys(SbS_matrices)));

for i=1:length(keys(SbS_matrices))
    tic;
    progressbar(['decode batch' num2str(i)]);
    
    mat = SbS_matrices(i)';
    serial_iter = sequential(i);
    batch_size = parallel(i)/sections;
    for section = 1:sections
        progressbar(section/sections);
        %curr_workers(i,section) = cluster_balancer();
        %curr_times(i,section)= toc;
        
        err_count = zeros(1,batch_size);
        undet_err = zeros(1,batch_size);
        
        parfor (j = 1:batch_size)
            result = test_code_B_MSDP(max_num_iter,serial_iter, num_reads, decode_mode, lp_p, mp_p, up_p, tp_p);
            err_count(1,j) = result(1);
            undet_err(1,j) = result(2);
        end
        total_err_count{i} = [total_err_count{i} err_count];
        total_undet_err{i} = [total_undet_err{i} undet_err];
        
        save('full_env.mat');
    end
    t_post = toc
end
